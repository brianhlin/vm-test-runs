# Master DAG for osg-test runs

# 1. Generate the test-run DAG and configuration files
JOB GenerateDAG generate-dag.sub

# 2. Create the test-run images
JOB CreateImages create-io-images.sub

# 3. Run the generated DAG
SUBDAG EXTERNAL RunTests test-run.dag

# 4. Analyze the output
JOB AnalyzeOutput analyze-test-run.sub
SCRIPT PRE AnalyzeOutput combine-job-analyses
SCRIPT POST AnalyzeOutput email-analysis

# 5. Produce html output
JOB HtmlOutput vmu-reporter.sub

# 6. Upload output to CSL
JOB UploadJobOutput upload-job-output.sub

# Connections - simple linear DAG (at this level)
PARENT GenerateDAG CHILD CreateImages
PARENT CreateImages CHILD RunTests
PARENT RunTests CHILD AnalyzeOutput
PARENT AnalyzeOutput CHILD HtmlOutput
PARENT HtmlOutput CHILD UploadJobOutput
